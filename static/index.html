<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Sistema POS profesional para botiller√≠a - Gesti√≥n de ventas, inventario y reportes">
    <meta name="theme-color" content="#2563eb">
    <title>Botiller√≠a POS - Sistema Profesional de Gesti√≥n</title>
    
    <!-- Favicon -->
    <link rel="icon" type="image/svg+xml" href="/static/favicon.svg">
    
    <!-- Preload Critical Resources -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    
    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    
    <!-- Styles -->
    <link rel="stylesheet" href="/static/pos-style.css">
</head>
<body>
    <!-- Navbar -->
    <nav class="navbar" role="navigation" aria-label="Navegaci√≥n principal">
        <div class="navbar-brand">
            <h1>üç∫ Botiller√≠a POS</h1>
        </div>
        <div class="navbar-menu" role="tablist">
            <button class="nav-btn active" data-view="pos" role="tab" aria-selected="true" aria-controls="view-pos">
                <span class="icon" aria-hidden="true">üí∞</span>
                Punto de Venta
            </button>
            <button class="nav-btn" data-view="productos" role="tab" aria-selected="false" aria-controls="view-productos">
                <span class="icon" aria-hidden="true">üì¶</span>
                Productos
            </button>
            <button class="nav-btn" data-view="retiros" role="tab" aria-selected="false" aria-controls="view-retiros">
                <span class="icon" aria-hidden="true">üì§</span>
                Retiros
            </button>
            <button class="nav-btn" data-view="ventas" role="tab" aria-selected="false" aria-controls="view-ventas">
                <span class="icon" aria-hidden="true">üìä</span>
                Reportes
            </button>
        </div>
        <div class="navbar-stats" aria-label="Estad√≠sticas del d√≠a">
            <div class="stat-item">
                <span class="stat-label">Ventas Hoy</span>
                <span class="stat-value" id="ventasHoy" aria-live="polite">$0</span>
            </div>
            <div class="stat-item">
                <span class="stat-label">Retiros Hoy</span>
                <span class="stat-value warning" id="retirosHoy" aria-live="polite">$0</span>
            </div>
            <div class="stat-item">
                <span class="stat-label">Utilidad Neta</span>
                <span class="stat-value success" id="utilidadNeta" aria-live="polite">$0</span>
            </div>
        </div>
    </nav>

    <!-- Vista: Punto de Venta -->
    <main id="view-pos" class="view active" role="tabpanel">
        <div class="module-header">
            <div class="header-info">
                <h2 class="module-title">üí∞ Punto de Venta</h2>
                <p class="module-subtitle">Sistema de ventas r√°pido y eficiente</p>
            </div>
        </div>
        <div class="pos-container">
            <!-- Panel de Productos -->
            <section class="products-panel" aria-label="Cat√°logo de productos">
                <div class="search-section">
                    <input 
                        type="text" 
                        id="posSearchInput" 
                        placeholder="üîç Buscar por c√≥digo o nombre (F2)"
                        class="search-input"
                        autocomplete="off"
                        aria-label="B√∫squeda de productos"
                    >
                </div>

                <!-- Filtros compactos -->
                <div class="pos-filters" role="region" aria-label="Filtros de productos">
                    <div class="filter-row">
                        <!-- Filtros de categor√≠a como pills -->
                        <div class="category-pills" role="radiogroup" aria-label="Filtrar por categor√≠a">
                            <button class="pill active" data-categoria="" role="radio" aria-checked="true">
                                üåü Todos
                            </button>
                            <button class="pill" data-categoria="Cervezas" role="radio" aria-checked="false">
                                üç∫
                            </button>
                            <button class="pill" data-categoria="Vinos" role="radio" aria-checked="false">
                                üç∑
                            </button>
                            <button class="pill" data-categoria="Licores" role="radio" aria-checked="false">
                                ü•É
                            </button>
                            <button class="pill" data-categoria="Bebidas" role="radio" aria-checked="false">
                                ü•§
                            </button>
                            <button class="pill" data-categoria="Snacks" role="radio" aria-checked="false">
                                üçø
                            </button>
                        </div>
                        
                        <!-- Filtros adicionales en selects compactos -->
                        <div class="filter-selects">
                            <select id="unidadFilter" class="compact-select" aria-label="Filtrar por unidad">
                                <option value="">‚öñÔ∏è Unidad</option>
                            </select>
                            <select id="marcaFilter" class="compact-select" aria-label="Filtrar por marca">
                                <option value="">üè≠ Marca</option>
                            </select>
                        </div>
                    </div>
                </div>

                <!-- Grid de productos -->
                <div id="posProductsGrid" class="products-grid" role="grid" aria-label="Lista de productos disponibles"></div>
            </section>

            <!-- Panel de Carrito -->
            <aside class="cart-panel" role="complementary" aria-label="Carrito de compras">
                <header class="cart-header">
                    <h2>üõí Carrito de Compra</h2>
                    <button id="clearCart" class="btn-action secondary" aria-label="Limpiar carrito">
                        <span class="btn-icon">üóëÔ∏è</span>
                        <span class="btn-text">Limpiar</span>
                    </button>
                </header>

                <div id="cartItems" class="cart-items" role="list" aria-label="Productos en el carrito"></div>

                <footer class="cart-summary" role="region" aria-label="Resumen de compra">
                    <div class="summary-row">
                        <span>Items:</span>
                        <span id="cartItemCount" aria-live="polite">0</span>
                    </div>
                    <div class="summary-row total">
                        <span>TOTAL:</span>
                        <span id="cartTotal" class="value" aria-live="assertive">$0</span>
                    </div>
                </footer>

                <div class="payment-section">
                    <label>üí≥ M√©todo de Pago</label>
                    <div class="payment-methods" role="radiogroup" aria-label="Seleccionar m√©todo de pago">
                        <button class="payment-btn active" data-metodo="efectivo" role="radio" aria-checked="true">
                            <span class="icon" aria-hidden="true">üíµ</span>
                            Efectivo
                        </button>
                        <button class="payment-btn" data-metodo="tarjeta" role="radio" aria-checked="false">
                            <span class="icon" aria-hidden="true">üí≥</span>
                            Tarjeta
                        </button>
                        <button class="payment-btn" data-metodo="transferencia" role="radio" aria-checked="false">
                            <span class="icon" aria-hidden="true">üì±</span>
                            Transferencia
                        </button>
                    </div>
                </div>

                <button id="processPayment" class="btn-action primary" aria-label="Procesar venta" style="width: 100%; justify-content: center; margin-top: 1rem;">
                    <span class="btn-icon">üí∞</span>
                    <span class="btn-text">Cobrar <span id="paymentTotal">$0</span></span>
                </button>
            </aside>
        </div>
    </main>

    <!-- Vista: Productos -->
    <div id="view-productos" class="view">
        <div class="module-header">
            <div class="header-info">
                <h2 class="module-title">üì¶ Gesti√≥n de Productos</h2>
                <p class="module-subtitle">Administra tu inventario de manera eficiente</p>
            </div>
            <div class="header-actions">
                <button id="btnNuevoProducto" class="btn-action primary">
                    <span class="btn-icon">‚ûï</span>
                    <span class="btn-text">Nuevo Producto</span>
                </button>
                <button id="exportData" class="btn-action secondary">
                    <span class="btn-icon">üìä</span>
                    <span class="btn-text">Exportar</span>
                </button>
            </div>
        </div>
        <div class="productos-layout">"

                <!-- B√∫squeda y Filtros -->
                <div class="productos-search">
                    <div class="search-group">
                        <div class="search-input-wrapper">
                            <span class="search-icon">üîç</span>
                            <input 
                                type="text" 
                                id="productSearchInput" 
                                placeholder="Buscar productos por c√≥digo, nombre o categor√≠a..."
                                autocomplete="off"
                            >
                        </div>
                        <button id="quickScanBtn" class="btn-scan">
                            <span class="icon">üî´</span>
                            Scanner
                        </button>
                    </div>
                    <div class="filter-pills">
                        <button class="filter-pill active" data-category="">Todos</button>
                        <button class="filter-pill" data-category="Cervezas">Cervezas</button>
                        <button class="filter-pill" data-category="Vinos">Vinos</button>
                        <button class="filter-pill" data-category="Licores">Licores</button>
                        <button class="filter-pill" data-category="Bebidas">Bebidas</button>
                        <button class="filter-pill" data-category="Snacks">Snacks</button>
                    </div>
                </div>

                <!-- Tabla de Productos Mejorada -->
                <div class="table-container">
                    <div class="table-content">
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th class="col-code">C√≥digo</th>
                                    <th class="col-name">Producto</th>
                                    <th class="col-category">Categor√≠a</th>
                                    <th class="col-price">Precio</th>
                                    <th class="col-stock">Stock</th>
                                    <th class="col-status">Estado</th>
                                    <th class="col-actions">Acciones</th>
                                </tr>
                            </thead>
                            <tbody id="productosTable"></tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- Panel Lateral - Formulario -->
            <div class="productos-sidebar">
                <div class="sidebar-content">
                    <!-- Formulario de Producto -->
                    <div id="productForm" class="product-form">
                        <div class="form-header">
                            <h3 id="formTitle">‚ûï Nuevo Producto</h3>
                            <button id="closeSidebar" class="btn-close">‚úï</button>
                        </div>

                        <form id="productoForm" class="form-content">
                            <input type="hidden" id="productId">
                            
                            <div class="form-section">
                                <h4>üìã Informaci√≥n B√°sica</h4>
                                
                                <div class="form-group">
                                    <label>C√≥digo del Producto *</label>
                                    <input type="text" id="codigo" placeholder="EAN, SKU o c√≥digo interno" required>
                                </div>

                                <div class="form-group">
                                    <label>Nombre del Producto *</label>
                                    <input type="text" id="nombre" placeholder="Nombre descriptivo del producto" required>
                                </div>

                                <div class="form-row">
                                    <div class="form-group">
                                        <label>Categor√≠a</label>
                                        <select id="categoria">
                                            <option value="">Seleccionar...</option>
                                            <option value="Cervezas">üç∫ Cervezas</option>
                                            <option value="Vinos">üç∑ Vinos</option>
                                            <option value="Licores">ü•É Licores</option>
                                            <option value="Bebidas">ü•§ Bebidas</option>
                                            <option value="Snacks">üçø Snacks</option>
                                            <option value="Otros">üì¶ Otros</option>
                                        </select>
                                    </div>
                                    <div class="form-group">
                                        <label>Marca</label>
                                        <input type="text" id="marca" placeholder="Ej: Cristal, Santa Rita">
                                    </div>
                                </div>

                                <div class="form-row">
                                    <div class="form-group">
                                        <label>Cantidad</label>
                                        <input type="number" id="cantidad" step="0.01" min="0" placeholder="500">
                                    </div>
                                    <div class="form-group">
                                        <label>Unidad</label>
                                        <select id="unidadMedida">
                                            <option value="">Seleccionar...</option>
                                            <option value="ml">üíß Mililitros (ml)</option>
                                            <option value="L">üíß Litros (L)</option>
                                            <option value="cc">üíß Cent√≠metros c√∫bicos (cc)</option>
                                            <option value="g">‚öñÔ∏è Gramos (g)</option>
                                            <option value="kg">‚öñÔ∏è Kilogramos (kg)</option>
                                            <option value="oz">‚öñÔ∏è Onzas (oz)</option>
                                            <option value="unidades">üìé Unidades</option>
                                            <option value="paquetes">üì¶ Paquetes</option>
                                        </select>
                                    </div>
                                </div>

                                <div class="form-row">
                                    <div class="form-group">
                                        <label>Volumen (Litros) - Legacy</label>
                                        <input type="number" id="litros" step="0.01" min="0" placeholder="0.33">
                                        <small class="form-hint">Solo para productos l√≠quidos existentes</small>
                                    </div>
                                    <div class="form-group">
                                        <label>URL Imagen</label>
                                        <input type="url" id="imagen_url" placeholder="https://...">
                                    </div>
                                </div>
                            </div>

                            <div class="form-section">
                                <h4>üí∞ Precios</h4>
                                
                                <div class="form-row">
                                    <div class="form-group">
                                        <label>Precio Compra *</label>
                                        <div class="input-with-currency">
                                            <span class="currency">$</span>
                                            <input type="number" id="precioCompra" step="1" min="0" placeholder="0" required>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label>Precio Venta *</label>
                                        <div class="input-with-currency">
                                            <span class="currency">$</span>
                                            <input type="number" id="precioVenta" step="1" min="0" placeholder="0" required>
                                        </div>
                                    </div>
                                </div>

                                <div class="profit-display">
                                    <span class="profit-label">Margen de ganancia:</span>
                                    <span id="profitMargin" class="profit-value">0%</span>
                                </div>
                            </div>

                            <div class="form-section">
                                <h4>üì¶ Inventario</h4>
                                
                                <div class="form-row">
                                    <div class="form-group">
                                        <label>Stock Actual</label>
                                        <input type="number" id="stock" min="0" value="0">
                                    </div>
                                    <div class="form-group">
                                        <label>Stock M√≠nimo</label>
                                        <input type="number" id="stockMinimo" min="0" value="5">
                                    </div>
                                </div>

                                <div class="form-group">
                                    <label>Descripci√≥n (Opcional)</label>
                                    <textarea id="descripcion" rows="3" placeholder="Informaci√≥n adicional del producto..."></textarea>
                                </div>
                            </div>

                            <div class="form-actions">
                                <button type="submit" class="btn-primary btn-large">
                                    <span class="icon">üíæ</span>
                                    Guardar Producto
                                </button>
                                <button type="button" id="cancelForm" class="btn-secondary btn-large">
                                    <span class="icon">üö´</span>
                                    Cancelar
                                </button>
                            </div>
                        </form>
                    </div>

                    <!-- Quick Stats -->
                    <div class="sidebar-stats">
                        <h4>üìä Resumen R√°pido</h4>
                        <div class="stat-grid">
                            <div class="stat-card">
                                <span class="stat-icon">üì¶</span>
                                <div class="stat-info">
                                    <span class="stat-number" id="totalProducts">0</span>
                                    <span class="stat-label">Productos</span>
                                </div>
                            </div>
                            <div class="stat-card">
                                <span class="stat-icon">‚ö†Ô∏è</span>
                                <div class="stat-info">
                                    <span class="stat-number" id="lowStock">0</span>
                                    <span class="stat-label">Stock Bajo</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Vista: Retiros -->
    <div id="view-retiros" class="view">
        <div class="retiro-container">
            <!-- Panel de Productos -->
            <div class="products-panel">
                <div class="module-header">
                    <div class="header-info">
                        <h2 class="module-title">üì§ Gesti√≥n de Retiros</h2>
                        <p class="module-subtitle">Registra consumo interno y p√©rdidas de inventario</p>
                    </div>
                </div>

                <div class="search-section">
                    <input 
                        type="text" 
                        id="retiroSearchInput" 
                        placeholder="üîç Buscar producto para retirar"
                        class="search-input"
                        autocomplete="off"
                    >
                </div>

                <!-- Grid de productos -->
                <div id="retiroProductsGrid" class="products-grid"></div>
            </div>

            <!-- Panel de Carrito de Retiro -->
            <div class="cart-panel">
                <div class="cart-header">
                    <h2>üìã Items a Retirar</h2>
                    <button id="clearRetiroCart" class="btn-action secondary">
                        <span class="btn-icon">üóëÔ∏è</span>
                        <span class="btn-text">Limpiar</span>
                    </button>
                </div>

                <div id="retiroCartItems" class="cart-items"></div>

                <div class="cart-summary">
                    <div class="summary-row">
                        <span>Items:</span>
                        <span id="retiroItemCount">0</span>
                    </div>
                    <div class="summary-row total warning">
                        <span>P√âRDIDA TOTAL:</span>
                        <span id="retiroTotal">$0</span>
                    </div>
                </div>

                <div class="payment-section">
                    <button id="processRetiro" class="btn-action danger" style="width: 100%; justify-content: center;">
                        <span class="btn-icon">üìé</span>
                        <span class="btn-text">Registrar Retiro</span>
                    </button>
                </div>
            </div>
        </div>

        <!-- Tabla de Retiros -->
        <div class="content-container" style="margin-top: 2rem;">
            <div class="module-header">
                <div class="header-info">
                    <h2 class="module-title">üìã Historial de Retiros</h2>
                    <p class="module-subtitle">Revisa todos los retiros y consumos registrados</p>
                </div>
            </div>

            <div class="table-container">
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>ID</th>
                            <th>Fecha</th>
                            <th>P√©rdida</th>
                        </tr>
                    </thead>
                    <tbody id="retirosTable"></tbody>
                </table>
            </div>
        </div>
    </div>

    <!-- Vista: Ventas -->
    <div id="view-ventas" class="view">
        <div class="content-container">
            <div class="module-header">
                <div class="header-info">
                    <h2 class="module-title">üìä Historial de Ventas</h2>
                    <p class="module-subtitle">Consulta y analiza el historial de transacciones</p>
                </div>
            </div>

            <div class="table-container">
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>ID</th>
                            <th>Fecha</th>
                            <th>Total</th>
                            <th>M√©todo</th>
                            <th>Acciones</th>
                        </tr>
     !-- Modal de agregar stock -->
    <div id="addStockModal" class="modal">
        <div class="modal-content modal-small">
            <span class="modal-close" onclick="closeStockModal()">&times;</span>
            <h2>‚ûï Agregar Stock</h2>
            <div id="stockProductInfo" class="product-info-card"></div>
            <form id="addStockForm" class="stock-form">
                <div class="form-group">
                    <label>Cantidad a Agregar *</label>
                    <input type="number" id="stockQuantity" min="1" required autofocus>
                </div>
                <div class="form-group">
                    <label>Stock Actual</label>
                    <input type="number" id="currentStock" readonly>
                </div>
                <div class="form-group">
                    <label>Stock Final</label>
                    <input type="number" id="finalStock" readonly>
                </div>
                <div class="form-actions">
                    <button type="submit" class="btn-primary">‚úÖ Confirmar</button>
                    <button type="button" class="btn-secondary" onclick="closeStockModal()">Cancelar</button>
                </div>
            </form>
        </div>
    </div>

    <               </thead>
                    <tbody id="ventasTable"></tbody>
                </table>
            </div>
        </div>
    </div>

    <!-- Modal de detalle de venta -->
    <div id="ventaModal" class="modal">
        <div class="modal-content">
            <span class="modal-close">&times;</span>
            <h2>Detalle de Venta</h2>
            <div id="ventaDetail"></div>
        </div>
    </div>

    <script src="/static/pos-app.js"></script>
</body>
</html>
